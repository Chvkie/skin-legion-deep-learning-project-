CNN3 = Sequential([
  Conv2D(32, 3, activation='relu', input_shape=(224, 224, 3)),
  Conv2D(64, 3, activation='relu'),
  MaxPool2D(),
  Conv2D(64, 3, activation='relu'),
  Conv2D(128, 3, activation='relu'),
  MaxPool2D(),
  Flatten(),
  Dense(7, activation='softmax')
])

# Compile the model
CNN3.compile(loss="categorical_crossentropy", # changed to categorical_crossentropy
                optimizer=tf.keras.optimizers.Adam(),
                metrics=["accuracy"])

early_stopping = tf.keras.callbacks.EarlyStopping(monitor="val_accuracy",
                                                  patience=5)

CNNhist3 = CNN3.fit(xtr,ytr,
                        epochs=20,
                        steps_per_epoch=len(xtr),
                        validation_data=(xval,yval),
                        validation_steps=len(xval),
                        callbacks= early_stopping)